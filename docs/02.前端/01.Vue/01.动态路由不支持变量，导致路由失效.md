---
title: åŠ¨æ€è·¯ç”±ä¸æ”¯æŒå˜é‡ï¼Œå¯¼è‡´è·¯ç”±å¤±æ•ˆ
date: 2020-12-22 21:41:07
permalink: /pages/0fb788/
categories:
  - å‰ç«¯
  - Vue
tags:
  -
---

## è·¯ç”±æ‡’åŠ è½½
å½“æ‰“åŒ…æž„å»ºåº”ç”¨æ—¶ï¼ŒJavaScript åŒ…ä¼šå˜å¾—éžå¸¸å¤§ï¼Œå½±å“é¡µé¢åŠ è½½ã€‚å¦‚æžœæˆ‘ä»¬èƒ½æŠŠä¸åŒè·¯ç”±å¯¹åº”çš„ç»„ä»¶åˆ†å‰²æˆä¸åŒçš„ä»£ç å—ï¼Œç„¶åŽå½“è·¯ç”±è¢«è®¿é—®çš„æ—¶å€™æ‰åŠ è½½å¯¹åº”
ç»„ä»¶ï¼Œè¿™æ ·å°±æ›´åŠ é«˜æ•ˆäº†ã€‚

ç»“åˆVue çš„[å¼‚æ­¥ç»„ä»¶](https://cn.vuejs.org/v2/guide/components-dynamic-async.html#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6)å’Œ
Webpack çš„[ä»£ç åˆ†å‰²åŠŸèƒ½](https://doc.webpack-china.org/guides/code-splitting-async/#require-ensure-/)ï¼Œè½»æ¾å®žçŽ°è·¯ç”±ç»„ä»¶çš„æ‡’åŠ è½½ã€‚

é¦–å…ˆï¼Œå¯ä»¥å°†å¼‚æ­¥ç»„ä»¶å®šä¹‰ä¸ºè¿”å›žä¸€ä¸ª Promise çš„å·¥åŽ‚å‡½æ•° (è¯¥å‡½æ•°è¿”å›žçš„ Promise åº”è¯¥ resolve ç»„ä»¶æœ¬èº«)ï¼š
```js
const Foo = () => Promise.resolve({ /* ç»„ä»¶å®šä¹‰å¯¹è±¡ */ })
```
ç¬¬äºŒï¼Œåœ¨ Webpack 2 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€ importè¯­æ³•æ¥å®šä¹‰ä»£ç åˆ†å—ç‚¹ (split point)ï¼š
```js
import('./Foo.vue') // è¿”å›ž Promise
```

::: tip æ³¨æ„
å¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯ Babelï¼Œä½ å°†éœ€è¦æ·»åŠ  [syntax-dynamic-import](https://babeljs.io/docs/plugins/syntax-dynamic-import/) æ’ä»¶ï¼Œ
æ‰èƒ½ä½¿ Babel å¯ä»¥æ­£ç¡®åœ°è§£æžè¯­æ³•ã€‚
:::
ç»“åˆè¿™ä¸¤è€…ï¼Œè¿™å°±æ˜¯å¦‚ä½•å®šä¹‰ä¸€ä¸ªèƒ½å¤Ÿè¢« Webpack è‡ªåŠ¨ä»£ç åˆ†å‰²çš„å¼‚æ­¥ç»„ä»¶ã€‚
```js
const Foo = () => import('./Foo.vue')
```

## ä½¿ç”¨å˜é‡
æœ‰æ—¶å€™è·¯ç”±ä¿¡æ¯éœ€è¦ä»ŽåŽå°æŽ¥å£èŽ·å–ï¼Œé‚£ä¹ˆè·¯ç”±ç»„ä»¶çš„è·¯å¾„å°†ä¼šæˆä¸ºä¸€ä¸ª`å˜é‡`ï¼Œå°±åƒä¸‹é¢çš„å†™æ³•
```js
// è·¯ç”±åŠ¨æ€æ‡’åŠ è½½
export const loadView = (view) => {
  return () => import(`@/${view}`)
}
```
importä¸­çš„`@`æ˜¯åœ¨vue.config.jsä¸­é…ç½®çš„è·¯å¾„åˆ«åï¼Œå¯ä»¥å°†ç›¸å¯¹è·¯å¾„å˜ä¸ºç»å¯¹è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥æ›´å¥½çš„ç»´æŠ¤è·¯ç”±ç»„ä»¶çš„è·¯å¾„
```js
chainWebpack: config => {
    config.resolve.alias
      .set('@', resolve('src')) // key,valueè‡ªè¡Œå®šä¹‰ï¼Œæ¯”å¦‚.set('@@', resolve('src/components'))
      .set('_c', resolve('src/components'))
      .set('_conf', resolve('./src/config'))
}
```

## é—®é¢˜æ¥äº†
### é—®é¢˜1ï¼šESLintæŠ¥é”™
![ESLintæŠ¥é”™](https://img.whalenas.com:283/image/20201222222618.png)
ä½¿ç”¨`lintOnSave: false`å…³é—­ESLintæ£€æŸ¥ï¼Œæš‚æ—¶æ— è§†è¯¥é”™è¯¯æç¤º
### é—®é¢˜2ï¼šé¡µé¢æ— æ³•åŠ è½½è·¯ç”±
`npm run dev`æ—¶è­¦å‘Šâš ï¸
![npm run dev](https://img.whalenas.com:283/image/20201222223221.png)
æ‰“å¼€é¡µé¢æç¤ºæ— æ³•è®°è½½è·¯ç”±

## è§£å†³æ–¹æ¡ˆ
å°†ä¸Šé¢çš„åŠ¨æ€æ‡’åŠ è½½è·¯ç”±ä»£ç ä¿®æ”¹ä¸€ä¸‹ï¼Œå³å¯è§£å†³ä¸Šè¿°é—®é¢˜
```js
export const loadView = (view) => { // è·¯ç”±æ‡’åŠ è½½
  return () => Promise.resolve(require(`@/${view}`).default)
}
```

## æ–°çš„é—®é¢˜åˆæ¥äº†
å†™æˆä¸Šé¢çš„å†™æ³•ä¹‹åŽï¼Œç”Ÿäº§çŽ¯å¢ƒIEåˆæ— æ³•è®¿é—®äº†ï¼Œæ˜¾ç¤ºjsæ–‡ä»¶ä¸­å­˜åœ¨`=>`ç¬¦å·ï¼Œä½†æ˜¯å¼€å‘çŽ¯å¢ƒä¸€åˆ‡æ­£å¸¸ã€‚

## ç»ˆæžè§£å†³æ–¹æ¡ˆ
æœ€ç»ˆä½¿ç”¨ä¸‹é¢çš„å¼•å…¥æ–¹å¼è§£å†³
```js
export const loadView = (view) => { // è·¯ç”±æ‡’åŠ è½½
  return (resolve) => require([`@/${view}`], resolve)
}
```

ç½ªé­ç¥¸é¦–æ˜¯ï¼ŒWebpack4ä¸­çš„åŠ¨æ€importä¸æ”¯æŒå˜é‡æ–¹å¼ï¼Œå¯¼è‡´åŠ¨æ€è·¯ç”±å¤±æ•ˆ


## 2020å¹´12æœˆ27æ—¥æ›´æ–°
åˆå‡ºçŽ°äº†æ–°çš„é—®é¢˜ðŸ˜“ï¼Œä½¿ç”¨ç»ˆæžè§£å†³æ–¹æ¡ˆä¼šå¯¼è‡´ç”Ÿäº§çŽ¯å¢ƒæ ·å¼é”™ä¹±ï¼ˆè¿˜ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŽŸå› å¯¼è‡´ï¼‰ï¼Œæœ€åŽé‡‡å–äº†ä¸€ä¸ªæŠ˜ä¸­çš„æ–¹æ¡ˆã€‚
```js
// è·¯ç”±æ‡’åŠ è½½
export const loadView = (view) => {
  if (process.env.NODE_ENV === 'production') {
    return () => import(`@/${view}`);
  } else {
    return (resolve) => require([`@/${view}`], resolve)
  }
}
```
